function GetStyle(){return $("style").html()}function printViewerDocument(n,t,i,r){var e=$("#"+n)[0].innerHTML,o=new Date,s="Print"+o.getTime(),u=window.open("about:blank",s,"left=0,top=0,width=800,height=1000"),f;u.document.write("<html>\n");u.document.write("<head><title>"+r+"<\/title>\n");navigator.userAgent.toLowerCase().indexOf("chrome")<0&&u.document.write('<link href="/_layouts/15/dit/styles/cmsStyles.css" rel="Stylesheet" type="text/css" />\n');f=GetStyle();u.document.write('<style type="text/css">'+f+"<\/style>");u.document.write("<script>\n");navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(u.document.write('var chromeCss = document.createElement("link");\n'),u.document.write('chromeCss.rel = "stylesheet";\n'),u.document.write('chromeCss.href = "/_layouts/15/dit/styles/cmsStyles.css";\n'),u.document.write('document.getElementsByTagName("head")[0].appendChild(chromeCss);\n'));u.document.write("function winPrint()\n");u.document.write("{\n");u.document.write("window.focus();\n");navigator.userAgent.toLowerCase().indexOf("chrome")>-1?u.document.write("printChrome();\n"):u.document.write("window.print();\n");navigator.userAgent.toLowerCase().indexOf("firefox")>-1?u.document.write("window.close();\n"):u.document.write("chkstate();\n");u.document.write("}\n");u.document.write("function chkstate()\n");u.document.write("{\n");u.document.write('if(document.readyState=="complete")');u.document.write("{\n");u.document.write("window.close();\n");u.document.write("}\n");u.document.write("else{\n");u.document.write('setTimeout("chkstate();",3000);\n');u.document.write("}\n");u.document.write("}\n");u.document.write("function printChrome()\n");u.document.write("{\n");u.document.write('if(document.readyState=="complete")');u.document.write("{\n");u.document.write("window.print();\n");u.document.write("}\n");u.document.write("else{\n");u.document.write('setTimeout("printChrome();",3000);\n');u.document.write("}\n");u.document.write("}\n");u.document.write("<\/script>");u.document.write("<\/head>");u.document.write('<body onload="winPrint()" >');u.document.write('<div style="background: #fff;height: 110px;text-align:left;padding:5px;"><img src="/Style%20Library/'+i+'/images/dit/logo.png" /><\/div><hr/><h2 style="font-size: 16px;font-weight: bold; text-align:center;margin:20px 0;" >');u.document.write(t);u.document.write("<\/h2>");u.document.write(e);u.document.write("<\/body><\/html>");u.document.close()}function increaseFont(){var i=$(".viewerContent").find("*").css("font-size"),t=parseFloat(i,10),n;if(t<25)return n=t*1.3,$(".viewerContent").find("*").css("font-size",n),localStorage.setItem("fntSizeCenterContent",n),!1}function decreaseFont(){var i=$(".viewerContent").find("*").css("font-size"),t=parseFloat(i,10),n;if(t>8)return n=t*.8,$(".viewerContent").find("*").css("font-size",n),localStorage.setItem("fntSizeCenterContent",n),!1}function ShowFootnote(n){Toast.showToast("",$("#"+n)[0].innerHTML)}function ShowOtherContent(n){window.location.href=_spPageContextInfo.webAbsoluteUrl+"/_layouts/15/dit/Pages/viewer.aspx?path="+n+"&IsDlg=1"}function sendMail(){$("#divSendMail").slideToggle("slow");$("input[type=text]").val("");$("textarea").val("")}function SearchURLByKey(n,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+t+"=([^&#]*)",u=new RegExp(r),i=u.exec(n);return i==null?"":decodeURIComponent(i[1].replace(/\+/g," "))}function GetParameterFromCurrentPage(n){var i=$("#TabData").text();n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+n+"=([^&#]*)",u=new RegExp(r),t=u.exec(i);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function ManageTabData(n,t,i,r,u){typeof n=="undefined"&&(n="");typeof t=="undefined"&&(t="");typeof i=="undefined"&&(i="");typeof r=="undefined"&&(r="");typeof u=="undefined"&&(u="");var f="",e=window.location.toString().split("?")[0];n==="path"?f="{4}?path={0}&grp={1}&searchFilter={2}&k={3}&IsDlg=1".format(t,i,r,u,e):n==="grp"?f="{4}?grp={0}&cname=CMSID&cval={1}&searchFilter={2}&k={3}&IsDlg=1".format(i,t,r,u,e):$("a.OpenTab").hide();$("#TabData").text(f)}function ShowViewerLoader(){$(".tabbreadcrumb").css("position","relative");$("#overlaybx_page").show();$("#divViewerProgresBar").show()}function HideViewerLoader(){$(".tabbreadcrumb").css("position","fixed");$("#overlaybx_page").hide();$("#divViewerProgresBar").hide()}function ShowCMSMainContent(n,t,i,r){function u(n){$("#viewerContainer #dvHtmlContent").html(n.HtmlContent);$("#viewerContainer #dvFooter").html(n.CopyrightMessage);$("#divActHeading").html(n.Title);$(".clsFilePath").text(n.FilePath);HideViewerLoader();$("body").highlightViewer(n.SearchText)}function f(n){$("#viewerContainer #dvHtmlContent").html(n.responseText)}(typeof r=="undefined"||r==="")&&(r="dit");n!=""&&i!=""&&$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/taxmann.iti.webservices/DataWebService.svc/ShowMainContent/"+i+"/"+n+"/"+r,contentType:"text/html",async:!0,type:"GET"}).done(Function.createDelegate(this,u)).error(Function.createDelegate(this,f))}function LoadCMSDataByCMSID(n,t,i,r,u,f,e){function c(n){$("#viewerContainer #dvHtmlContent").html(n.HtmlContent);$("#viewerContainer #dvFooter").html(n.CopyrightMessage);$("#divActHeading").html(n.Title);$(".clsFilePath").text(n.FilePath);var t=$("#ViewerPreviousButton"),i=$("#ViewerNextButton"),r=$("li.ViewerPager");(n.PreviousLink!=null||n.NextLink!=null)&&r.show();n.PreviousLink!==null?t.attr("href",n.PreviousLink).removeClass("disable"):t.removeAttr("href").addClass("disable");n.NextLink!==null?i.attr("href",n.NextLink).removeClass("disable"):i.removeAttr("href").addClass("disable");HideViewerLoader();$("body").highlightViewer(n.SearchText)}function l(n){$("#viewerContainer #dvHtmlContent").html(n.responseText)}var o=encodeURIComponent(r),s=encodeURIComponent(n),h=encodeURIComponent(e);typeof f=="undefined"&&(f="");n!=""&&i!=""&&$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/taxmann.iti.webservices/DataWebService.svc/GetFileContentsByCMSID?cval="+i+"&grp="+s+"&searchFilter="+o+"&filterBy="+u+"&opt="+f+"&k="+h,contentType:"text/html",async:!0,type:"GET"}).done(Function.createDelegate(this,c)).error(Function.createDelegate(this,l))}function LoadCMSDataByFilePath(n,t,i,r){function o(n){$("#viewerContainer #dvHtmlContent").html(n.HtmlContent);$("#viewerContainer #dvFooter").html(n.CopyrightMessage);$("#divActHeading").html(n.Title);$(".clsFilePath").text(n.FilePath);var t=$("#ViewerPreviousButton"),i=$("#ViewerNextButton"),r=$("li.ViewerPager");(n.PreviousLink!=null||n.NextLink!=null)&&r.show();n.PreviousLink!==null?t.attr("href",n.PreviousLink).removeClass("disable"):t.removeAttr("href").addClass("disable");n.NextLink!==null?i.attr("href",n.NextLink).removeClass("disable"):i.removeAttr("href").addClass("disable");HideViewerLoader();$("body").highlightViewer(n.SearchText)}function s(n){$("#viewerContainer #dvHtmlContent").html(n.responseText)}var u=encodeURIComponent(i),f=encodeURIComponent(t),e=encodeURIComponent(r);typeof r=="undefined"&&(r="");n!=""&&$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/taxmann.iti.webservices/DataWebService.svc/GetFileContentsByPath?path="+n+"&grp="+f+"&searchFilter="+u+"&k="+e,contentType:"text/html",async:!0,type:"GET"}).done(Function.createDelegate(this,o)).error(Function.createDelegate(this,s))}function CheckDocumentRelation(n,t){function i(t){typeof t!="undefined"&&(t?$("#ShowRelatedDocumentLinksPopup").attr("aria-label",n).show():$("#ShowRelatedDocumentLinksPopup").hide())}function r(){$("#ShowRelatedDocumentLinksPopup").hide()}n!=""&&$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/taxmann.iti.webservices/DataWebService.svc/CheckDocumentRelation?searchText="+n+"&isCMSID="+t,contentType:"text/html",async:!0,type:"GET"}).done(Function.createDelegate(this,i)).error(Function.createDelegate(this,r))}function ShowLinkedDocuments(n,t,i){function r(n){typeof n!="undefined"&&n!==""?($("#overlaybx_relatedDoc").show(),$("#related_doc_bx").html(n).show(),UpdateAllExternalLinks()):($("#overlaybx_relatedDoc").hide(),$("#related_doc_bx").html("").hide());AttachRelatedLinks()}function u(n){$("#viewerContainer #dvHtmlContent").html(n.responseText)}n!=""&&t!=""&&$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/taxmann.iti.webservices/DataWebService.svc/GetRelatedDocuments?grp="+n+"&searchText="+t+"&isCMSID="+i,contentType:"text/html",async:!0,type:"GET"}).done(Function.createDelegate(this,r)).error(Function.createDelegate(this,u))}function CloseRelatedPopup(){$("#overlaybx_relatedDoc").hide();$("#related_doc_bx").html("").hide()}function AttachRelatedLinks(){$("a.relFaqContents").click(function(){$(this).next().show()});$("a.fileopenclose").click(function(){$("div.FileOpenBx").hide()})}var Toast=function(){function u(t,u){document.getElementById(n)==null&&f();document.getElementById(i).innerHTML=t;document.getElementById(r).innerHTML=u;$?($("#"+n).hide(),$("#"+n).show("slow")):(n.style.display="none",n.style.display="block")}function f(){var i,u,f,e,r=function(n,t,i){for(var u=document.createElement(n),r=0;r<t.length;r++)u.setAttribute(t[r][0],t[r][1]);return i&&(u.innerHTML=i),u},o;i=r("div",[["style","background-color:#eaeaea;border-top: 1px solid #999;position:fixed;bottom:0px;width:100%;text-align:center;max-height: 50%;overflow: auto;font-size:12px;"],["id",n]]);o="text-align:right;padding-right:10px;font-size:10pt;cursor:pointer;position:absolute;right: 0;top: 0;";u=r("div",[["style",o],["id",t]],"");f=r("span",[["style","cursor:pointer;background: #999;padding: 1px 5px;color: #fff;"],["onclick","Toast.close()"]],"X");u.appendChild(f);e=r("div",[["id","divOutput"],["style","margin-top:0px"]],"<div id='lblNotice' style='font-weight:bold;margin-top:0px;'><\/div><div id='lblOutput' style='width: auto;text-align: left;margin: 10px 25px 10px 10px;'><\/div>");i.appendChild(u);i.appendChild(e);document.body.appendChild(i)}function e(){$?$("#"+n).hide("slow"):n.style.display="none"}var n="divToast",t="btnClose",i="lblNotice",r="lblOutput";return{showToast:u,close:e}}();$(document).ready(function(){currentFontSizeNum=parseFloat(localStorage.getItem("fntSizeCenterContent"),10);currentFontSizeNum!=null&&currentFontSizeNum>0&&$(".viewerContent").find("*").css("font-size",currentFontSizeNum)});$(document).ready(function(){$("a.decreaseFont").click(function(){decreaseFont()});$("a.increaseFont").click(function(){increaseFont()});$("a.normalFont").click(function(){normalFont()})});typeof $!="undefined"&&($("#contrastTheme").click(function(){$("#darkCSS2").remove();$("head").append('<link rel="stylesheet" href="/_layouts/15/'+_spPageContextInfo.currentLanguage+'/styles/Themable/dit/darkTheme.css?V2" id="darkCSS2" type="text/css" />')}),$("#normalTheme").click(function(){$("#darkCSS2").remove()}));String.prototype.format=function(){for(var i,t=this,n=0;n<arguments.length;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n]);return t};$(document).ready(function(){$("#ShowRelatedDocumentLinksPopup").click(function(){var n=$(this).attr("aria-label"),t;typeof n!="undefined"&&n!==""&&(t=GetParameterFromCurrentPage("grp"),ShowLinkedDocuments(t,n,!0))})});