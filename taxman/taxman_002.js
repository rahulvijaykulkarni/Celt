function todayDay(){var n=new Date,t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n.getDay()],i=n.getMonth()+1,r=n.getYear();return t}function todayDate(){var n=new Date;return n.format("MM/dd/yyyy")}function CreateNewStatisticsRecord(){CheckRecordExist(todayDate(),"Statistics")}function CheckRecordExist(n,t){var i=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('"+t+"')/items?$filter=Date eq '"+n+"'";$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){if(i.d.results.length<=0)AddNewRecord(t);else{var r=i.d.results[0].Count;Update(t,n,r)}},error:function(n){alert(n)}})}function AddNewRecord(n){CreateListItemWithDetails(n,_spPageContextInfo.webAbsoluteUrl,function(){},function(){})}function CreateListItemWithDetails(n,t,i,r){var u=GetItemTypeForListName(n),f={__metadata:{type:u},Date:todayDate(),Count:1};$.ajax({url:_spPageContextInfo.siteAbsoluteUrl+"/_api/web/lists/getbytitle('"+n+"')/items",type:"POST",contentType:"application/json;odata=verbose",data:JSON.stringify(f),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(n){i(n)},error:function(n){r(n)}})}function GetItemTypeForListName(n){return"SP.Data."+n.charAt(0).toUpperCase()+n.split(" ").join("").slice(1)+"ListItem"}function GetListItemWithId(n,t,i,r,u){var f=i+"/_api/web/lists/getbytitle('"+t+"')/items?$filter=Date eq '"+n+"'";$.ajax({url:f,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){n.d.results.length==1?r(n.d.results[0]):u("Multiple results obtained for the specified Id value")},error:function(n){u(n)}})}function Read(){var n=_spPageContextInfo.webAbsoluteUrl;getListItems("Statistics",n,function(n){for(var i=n.d.results,t=0;t<i.length;t++)alert(i[t].Title+":"+i[t].Id)},function(){alert("Ooops, an error occured. Please try again")})}function getListItems(n,t,i,r){$.ajax({url:t+"/_api/web/lists/getbytitle('"+n+"')/items",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){i(n)},error:function(n){r(n)}})}function Update(n,t,i){var r=_spPageContextInfo.webAbsoluteUrl,u=i+1;UpdateListItem(t,n,r,u,function(){},function(){alert("Ooops, an error occured. Please try again")})}function UpdateListItem(n,t,i,r,u,f){var e=GetItemTypeForListName(t),o={__metadata:{type:e},Date:todayDate(),Count:r};GetListItemWithId(n,t,i,function(n){$.ajax({url:n.__metadata.uri,type:"POST",contentType:"application/json;odata=verbose",data:JSON.stringify(o),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":n.__metadata.etag},success:function(n){u(n)},error:function(n){f(n)}})},function(n){f(n)})}